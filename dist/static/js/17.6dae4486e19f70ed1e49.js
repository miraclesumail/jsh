webpackJsonp([17],{lsas:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=s("Dd8w"),a=s.n(o),n=s("NYxO"),r={name:"modify_tel",data:function(){return{step:1,reciprocal:0,timer:null,oldPhoneNumber:"",sendData:{smsCode:"",newPhoneNumber:""}}},methods:a()({},Object(n.b)(["setLogin"]),{getCodeOld:function(){var e=this;this.reciprocal||this.$api.sendSMSCodeToPlayer({purpose:"oldPhoneNumber"}).then(function(t){e.reciprocalFun()})},getCodeNew:function(){var e=this,t=this.$tool.phoneNumber(this.sendData.newPhoneNumber);if(t)this.$tool.CONFIRM({text:t});else if(!this.reciprocal){var s={phoneNumber:this.sendData.newPhoneNumber,purpose:"newPhoneNumber"};this.platform.twoStepsForModifyPhoneNumber||(s.oldPhoneNumber=this.oldPhoneNumber),this.$api.getSMSCode(s).then(function(t){e.reciprocalFun()})}},reciprocalFun:function(){var e=this;this.reciprocal=60,this.timer=setInterval(function(){e.reciprocal--,0==e.reciprocal&&clearInterval(e.timer)},1e3)},send:function(){var e=this;if(this.platform.twoStepsForModifyPhoneNumber)this.$api.verifyPhoneNumberBySMSCode({smsCode:this.sendData.smsCode}).then(function(t){t.data&&(e.step=2,e.sendData.smsCode="",e.reciprocal=0,clearInterval(e.timer),e.$tool.ALERT({text:"身份验证通过，请输入新手机号码"}))});else{var t=this.$tool.phoneNumber(this.oldPhoneNumber);t?this.$tool.CONFIRM({text:t}):this.step=2}},sendNew:function(){var e=this,t=this.sendData.newPhoneNumber;this.platform.twoStepsForModifyPhoneNumber&&delete this.sendData.newPhoneNumber,this.$api.updatePhoneNumberWithSMS(this.sendData).then(function(s){e.$tool.SET_STATE({name:"player",content:t.substring(0,3)+"****"+t.substring(7),sub:"phoneNumber"}),e.$tool.setStore("player",e.player),e.$tool.CONFIRM({text:"新手机号码更换成功",okFun:function(){e.$router.go(-1)}})})}}),mounted:function(){},computed:a()({},Object(n.d)(["platform","cfUrl","player"]))},i={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"modify_tel"},[s("crumbs",{attrs:{icon:1==e.step?"icon_name":"icon_tel",title:1==e.step?"身份验证":"新手机号码"}}),e._v(" "),1==e.step?s("div",{staticClass:"form_box2"},[s("div",{staticClass:"item item_input",attrs:{flex:"box:first cross:center"}},[s("div",{staticClass:"name"},[e._v("旧手机号")]),e._v(" "),s("div",{staticClass:"text_box",attrs:{flex:"cross:center"}},[e.platform.twoStepsForModifyPhoneNumber?s("input",{directives:[{name:"model",rawName:"v-model",value:e.player.phoneNumber,expression:"player.phoneNumber"}],staticClass:"disable",attrs:{type:"tel",maxlength:"11",placeholder:"请输入旧手机号"},domProps:{value:e.player.phoneNumber},on:{input:function(t){t.target.composing||e.$set(e.player,"phoneNumber",t.target.value)}}}):s("input",{directives:[{name:"model",rawName:"v-model",value:e.oldPhoneNumber,expression:"oldPhoneNumber"}],attrs:{type:"tel",maxlength:"11",placeholder:"请输入旧手机号"},domProps:{value:e.oldPhoneNumber},on:{input:function(t){t.target.composing||(e.oldPhoneNumber=t.target.value)}}})])]),e._v(" "),e.platform.twoStepsForModifyPhoneNumber?s("div",{staticClass:"item item_input",attrs:{flex:"box:first cross:center"}},[s("div",{staticClass:"name"},[e._v("验证码")]),e._v(" "),s("div",{staticClass:"text_box",attrs:{flex:"cross:center box:last"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.sendData.smsCode,expression:"sendData.smsCode"}],attrs:{type:"tel",maxlength:"4",placeholder:"请输入短信验证码"},domProps:{value:e.sendData.smsCode},on:{input:function(t){t.target.composing||e.$set(e.sendData,"smsCode",t.target.value)}}}),e._v(" "),e.reciprocal?s("span",{staticClass:"get_code red"},[e._v(e._s(e.reciprocal)+"s")]):s("div",{staticClass:"get_code",on:{click:e.getCodeOld}},[e._v("获取验证码")])])]):e._e(),e._v(" "),s("div",{staticClass:"item item_btn"},[s("div",{staticClass:"btn",on:{click:e.send}},[e._v("开始验证")])])]):s("div",{staticClass:"form_box2"},[s("div",{staticClass:"item item_input",attrs:{flex:"box:first cross:center"}},[s("div",{staticClass:"name"},[e._v("新手机号")]),e._v(" "),s("div",{staticClass:"text_box",attrs:{flex:"cross:center"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.sendData.newPhoneNumber,expression:"sendData.newPhoneNumber"}],attrs:{type:"tel",maxlength:"11",placeholder:"请输入新手机号码"},domProps:{value:e.sendData.newPhoneNumber},on:{input:function(t){t.target.composing||e.$set(e.sendData,"newPhoneNumber",t.target.value)}}})])]),e._v(" "),s("div",{staticClass:"item item_input",attrs:{flex:"box:first cross:center"}},[s("div",{staticClass:"name"},[e._v("验证码")]),e._v(" "),s("div",{staticClass:"text_box",attrs:{flex:"cross:center box:last"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.sendData.smsCode,expression:"sendData.smsCode"}],attrs:{type:"tel",maxlength:"4",placeholder:"请输入短信验证码"},domProps:{value:e.sendData.smsCode},on:{input:function(t){t.target.composing||e.$set(e.sendData,"smsCode",t.target.value)}}}),e._v(" "),e.reciprocal?s("span",{staticClass:"get_code red"},[e._v(e._s(e.reciprocal)+"s")]):s("div",{staticClass:"get_code",on:{click:e.getCodeNew}},[e._v("获取验证码")])])]),e._v(" "),s("div",{staticClass:"item item_btn"},[s("div",{staticClass:"btn",on:{click:e.sendNew}},[e._v("更换号码")])])]),e._v(" "),1==e.step?s("a",{staticClass:"service",attrs:{href:e.cfUrl,target:"_bank"}},[e._v("手机无法接受验证码？")]):e._e()],1)},staticRenderFns:[]},l=s("VU/8")(r,i,!1,null,null,null);t.default=l.exports}});