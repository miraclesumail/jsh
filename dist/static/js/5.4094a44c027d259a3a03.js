webpackJsonp([5],{nb2z:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=n("Dd8w"),a=n.n(s),o=n("NYxO"),i={name:"discount_detail",data:function(){return{bonus:{},list:[],rule:[],type:"",show:[],tableImg:"",sendData:{code:this.$route.query.code,eventCode:this.$route.query.code,data:null,_closeCONFIRM:!0}}},props:[],components:{},methods:a()({},Object(o.b)(["setWallet"]),Object(o.c)(["CONFIRM"]),{getRemark:function(t){var e=t.split("=")[1];return e=(e=e.replace(/deposit/,"存款")).replace(/gift/,"优惠")+"倍"},send:function(){var t=this;if(!this.sendData.code.includes("_client")||all.versions.isAndroidApp||all.versions.isIosApp){var e="applyRewardEvent";if("PlayerConsumptionReturn"==this.type)e="requestConsumeRebate";else if("service"==this.type)return void this.$tool.CONFIRM({text:"此优惠需在满足条件后联系客服申请",okName:"联系客服",okFun:function(){window.open(t.cfUrl)}});this.rule&&this.rule[0]&&0==this.rule[0].rewardAmount?this.$tool.CONFIRM({text:"您的等级条件不满足"}):this.$api[e](this.sendData).then(function(e){t.$tool.CONFIRM({text:"优惠添加成功，祝您游戏愉快"}),t.init()}).catch(function(e){var n=e.errorMessage;"无法找到此存款记录，详情请联系客服"==n||"未达到周期内存款笔数条件"==n||"玩家的周期内的累积存款金额不足"==n?t.$tool.CONFIRM({text:"您的存款条件不满足此优惠，请前往存款",okFun:function(){t.$router.push("/access")}}):"您已经达到了该奖励周期内的申请上限"==n?t.$tool.CONFIRM({text:"您已领取过此优惠，请选择其他优惠"}):"玩家的周期内的累积输值金额不足"==n?t.$tool.CONFIRM({text:"您的输值金额不满足申请条件"}):"Error finding reward event"==n&&"PlayerConsumptionReturn"==t.type?t.$tool.CONFIRM({text:"优惠条件不满足，此优惠需vip会员及以上才能申请"}):t.$tool.CONFIRM({text:n})})}else this.$tool.CONFIRM({text:"此优惠需在手机移动端申请，请下载app后申请",okName:"前往下载",okFun:function(){t.$router.push("/index/downLoad")},nofun:function(){}})},init:function(){var t=this;this.$api.getRewardList().then(function(e){t.bonus=t.$tool.findVal(e.data,t.$route.query.code,"code");var n=t.bonus.list,s=t.bonus.type.name,a=t.bonus.param.rewardParam||[],o=t.bonus.param.rewardParam&&t.bonus.param.rewardParam[0].value;a.length>1?o=a[t.level]&&a[t.level].value:1==a.length&&(o=a[0].value),"PlayerConsumptionReturn"==s&&(o=t.bonus.param,t.tableImg=o.imageUrl[1]),t.bonus.condition&&(t.tableImg=t.bonus.condition.imageUrl[1]),n.map(function(e,n){if(0==e.displayId);else{var s=e.displayTextContent.split("；");s.remove(s[s.length-1]),t.list.push({title:e.displayTitle,content:s})}}),t.rule=o,t.sendData.code.includes("_service")&&(s="service"),t.type=s,"PlayerTopUpReturnGroup"==s?t.$api.getTopupList({bDirty:!1,bSinceLastConsumption:!0,requestCount:1}).then(function(e){var n=e.data.records[0],s=0,a=0,i=0;if(n){i=n.amount,t.sendData.data={topUpRecordId:n._id};var r=o[0];o.map(function(t,e){t.minTopUpAmount<=i&&r.minTopUpAmount<t.minTopUpAmount&&(r=t)}),r.rewardAmount?(s=r.rewardAmount,a=r.spendingTimesOnReward*r.rewardAmount):r.rewardPercentage&&(s=r.maxRewardInSingleTopUp&&r.maxRewardInSingleTopUp<=i*r.rewardPercentage?r.maxRewardInSingleTopUp:i*r.rewardPercentage,a=r.spendingTimes*(s+i))}var l=t.$route.query.code;t.show=[{name:l.includes("irstDeposit")?"首次充值":"最新充值",content:"¥ "+i},{name:"优惠金额",content:"¥ "+s,color:"red"},{name:"流水要求",content:"¥ "+a}]}):"PlayerLoseReturnRewardGroup"==s?t.show=[{name:"会员等级",content:t.levelVal}]:"PlayerConsumptionReturn"==s?t.$api.getConsumeRebateAmount({eventCode:t.sendData.code}).then(function(e){t.show=[{name:"会员等级",content:t.levelVal},{name:"开始时间",content:e.data.settleTime.startTime.getDate().substr(5,11)},{name:"结束时间",content:e.data.settleTime.endTime.getDate().substr(5,11)},{name:"有效投注",content:e.data.totalConsumptionAmount.toFixed(2)},{name:"洗码金额",content:e.data.totalAmount.toFixed(2),color:"red"}]}):(s="service")&&(t.show=[{name:"会员等级",content:t.levelVal}])})}}),created:function(){this.active=this["list"+this.id]},mounted:function(){this.init()},computed:a()({},Object(o.d)(["player","cfUrl"]),{levelVal:function(){return this.player.levelName},level:function(){return this.player.levelVal}})},r={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"discount_detail"},[n("scroll",[n("div",[n("div",{staticClass:"bonus_title"},[n("div",{staticClass:"name"},[t._v(t._s(t.bonus.name))])]),t._v(" "),n("div",{staticClass:"apply"},[n("div",{staticClass:"more"},t._l(t.show,function(e,s){return n("div",{key:s},[t._v(t._s(e.name)+"："),n("span",{style:{color:e.color}},[t._v(t._s(e.content))])])})),t._v(" "),n("div",{staticClass:"btn_yellow",on:{click:t.send}})]),t._v(" "),n("div",{staticClass:"text_warn"},[t.tableImg?n("div",{staticClass:"imgbox"},[n("img",{attrs:{src:t.tableImg}})]):t._e(),t._v(" "),t._l(t.list,function(e,s){return n("div",{key:s,staticClass:"list"},[n("div",[t._v(t._s(e.title)+" :")]),t._v(" "),t._l(e.content,function(e,s){return n("p",{key:s},[n("span",[t._v(t._s(s+1)+".")]),t._v(t._s(e)+"\n                        ")])})],2)})],2)])])],1)},staticRenderFns:[]},l=n("VU/8")(i,r,!1,null,null,null);e.default=l.exports},pFoN:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});n("NYxO");var s={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"discount"},[n("scroll",[n("div",t._l(t.proms,function(e,s){return n("div",{key:s,staticClass:"list"},[n("div",{staticClass:"title",class:e.className,attrs:{flex:"main:center cross:center"}},[n("img",{attrs:{src:e.src}})]),t._v(" "),n("div",{staticClass:"box",attrs:{flex:""}},t._l(e.list,function(t,e){return n("router-link",{key:e,staticClass:"item",attrs:{to:{path:"/account/discountDetail",query:{code:t.code}},tag:"div",flex:"cross:center main:center"}},[n("img",{attrs:{src:t.src}})])}))])}))])],1)},staticRenderFns:[]},a=n("VU/8")({data:function(){return{path:"",promotionNameList:["自助结算洗码"],RewardList:[],active:this.$route.query.tab||0,proms:[{name:"限时优惠",className:"bonus_title1",list:[]},{name:"电子类优惠",className:"bonus_title2",list:[]},{name:"更多优惠",className:"bonus_title3",list:[]}]}},props:["name"],methods:{tab:function(t){this.$router.push({query:{tab:t}}),this.active=t},goTo:function(t){t.path?this.$router.push({path:t.path,query:{code:t.code,type:t.type}}):this.$tool.ALERT({text:"即将开始"})}},mounted:function(){var t=this;this.$api.getRewardList().then(function(e){t.rewardList=e.data||[],t.rewardList.map(function(e,n){var s=e.code;if(s.includes("_bonus")){var a="";a="PlayerConsumptionReturn"==e.type.name?e.param.imageUrl[0]:e.condition.imageUrl[0],s.includes("_tab0")?t.proms[0].list.push({code:e.code,src:a,index:a[a.length-1]}):s.includes("_tab1")?t.proms[1].list.push({code:e.code,src:a,index:a[a.length-1]}):s.includes("_tab2")&&t.proms[2].list.push({code:e.code,src:a,index:a[a.length-1]})}}),t.proms.map(function(t,e){t.list.sort(function(t,e){return t.index>e.index})})})}},s,!1,null,null,null);e.default=a.exports}});