webpackJsonp([8],{btwQ:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("Dd8w"),s=a.n(n),i=a("ctWk"),o=a("NYxO"),r={name:"modify_bank",data:function(){return{step:1,reciprocal:0,timer:null,bankInfoShow:!0,bankInfo:[],address:{},sendData:{bankAccountName:"",bankAccount:"",bankName:"",bankAccountType:"",bankAccountProvince:"",bankAccountCity:"",bankAddress:"",smsCode:""}}},components:{GetAddress:i.a},methods:s()({},Object(o.b)(["setLogin"]),{init:function(){var t=this;this.bankInfoShow=!!this.player.realName,this.$api.get().then(function(e){var a=e.data,n=[{name:"收款人",content:a.realName},{name:"银行卡号",content:a.bankAccount},{name:"银行名称",content:t.bankNames[a.bankName]},{name:"银行卡类别",content:"2"==a.bankAccountType?"储蓄卡":"信用卡"},{name:"开户省市",content:(a.bankAccountProvince||"")+(a.bankAccountCity||"")},{name:"开户支行",content:a.bankAddress}];t.bankInfo=n,t.sendData.bankAccountName=a.bankAccountName,t.sendData.bankName=a.bankName||"1",t.sendData.bankAccountType=a.bankAccountType||"2";var s={provinceId:a.bankAccountProvinceId,cityId:a.bankAccountCityId};t.address=s})},getCode:function(){var t=this;this.reciprocal||this.validate(1)||this.$api.sendSMSCodeToPlayer({purpose:"updateBankInfo"}).then(function(e){t.reciprocalFun()})},reciprocalFun:function(){var t=this;this.reciprocal=60,this.timer=setInterval(function(){t.reciprocal--,0==t.reciprocal&&clearInterval(t.timer)},1e3)},validate:function(t){var e="";return this.player.realName||(e=this.$tool.realName(this.sendData.bankAccountName)),e||(e=this.$tool.realBankNumber(this.sendData.bankAccount)),e||this.sendData.bankAddress||(e="支行信息不能为空"),!e&&1!=t&&this.platform.needSMSForModifyBankInfo&&(e=this.$tool.smsCode(this.sendData.smsCode)),e&&this.$tool.CONFIRM({text:e}),!!e},send:function(){var t=this;this.validate()||(this.sendData.bankAccountProvince=this.address.provinceId,this.sendData.bankAccountCity=this.address.cityId,this.platform.needSMSForModifyBankInfo||delete this.sendData.smsCode,this.$api.updatePaymentInfo(this.sendData).then(function(e){t.init(),t.bankInfoShow=!0,t.player.realName||(t.$tool.SET_STATE({name:"player",content:t.sendData.bankAccountName,sub:"realName"}),t.$tool.setStore("player",t.player))}))}}),mounted:function(){this.init()},computed:s()({},Object(o.d)(["platform","player","bankNames"]))},c={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"modify_bank"},[a("crumbs",{attrs:{icon:"icon_bank",title:"提款银行卡"}}),t._v(" "),t.bankInfoShow?a("div",{staticClass:"table_box"},[a("table",[t._m(0),t._v(" "),t._l(t.bankInfo,function(e,n){return a("tr",{key:n},[a("td",{staticClass:"text_md"},[t._v(t._s(e.name))]),t._v(" "),a("td",{staticClass:"text_md"},[t._v(t._s(e.content))])])})],2),t._v(" "),a("div",{staticClass:"btn btn_change",on:{click:function(e){t.bankInfoShow=!1}}},[t._v("更新银行卡")])]):a("div",{staticClass:"form_box2"},[a("div",{staticClass:"item item_input",attrs:{flex:"box:first cross:center"}},[a("div",{staticClass:"name"},[t._v("收款人")]),t._v(" "),a("div",{staticClass:"text_box",attrs:{flex:"cross:center"}},[a("input",{directives:[{name:"model",rawName:"v-model.lazy",value:t.sendData.bankAccountName,expression:"sendData.bankAccountName",modifiers:{lazy:!0}}],class:{disable:t.$tool.findVal(t.bankInfo,"收款人","name").content},attrs:{type:"text",placeholder:"请输入真实姓名"},domProps:{value:t.sendData.bankAccountName},on:{change:function(e){t.$set(t.sendData,"bankAccountName",e.target.value)}}})])]),t._v(" "),a("div",{staticClass:"item item_input",attrs:{flex:"box:first cross:center"}},[a("div",{staticClass:"name"},[t._v("收款银行")]),t._v(" "),a("div",{staticClass:"text_box",attrs:{flex:"cross:center"}},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.sendData.bankName,expression:"sendData.bankName"}],attrs:{name:"bank"},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.$set(t.sendData,"bankName",e.target.multiple?a:a[0])}}},t._l(t.bankNames,function(e,n){return a("option",{key:n,domProps:{value:n}},[t._v("\n                        "+t._s(e)+"\n                    ")])})),t._v(" "),a("i")])]),t._v(" "),a("div",{staticClass:"item item_input",attrs:{flex:"box:first cross:center"}},[a("div",{staticClass:"name"},[t._v("账户类型")]),t._v(" "),a("div",{staticClass:"text_box",attrs:{flex:"cross:center"}},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.sendData.bankAccountType,expression:"sendData.bankAccountType"}],on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.$set(t.sendData,"bankAccountType",e.target.multiple?a:a[0])}}},[a("option",{attrs:{value:"1"}},[t._v("信用卡")]),t._v(" "),a("option",{attrs:{value:"2"}},[t._v("储蓄卡")])]),t._v(" "),a("i")])]),t._v(" "),a("GetAddress",{model:{value:t.address,callback:function(e){t.address=e},expression:"address"}}),t._v(" "),a("div",{staticClass:"item item_input",attrs:{flex:"box:first cross:center"}},[a("div",{staticClass:"name"},[t._v("银行账号")]),t._v(" "),a("div",{staticClass:"text_box",attrs:{flex:"cross:center"}},[a("input",{directives:[{name:"model",rawName:"v-model.lazy",value:t.sendData.bankAccount,expression:"sendData.bankAccount",modifiers:{lazy:!0}},{name:"pattern",rawName:"v-pattern"}],attrs:{type:"tel",maxlength:"21",placeholder:"请输入银行账号"},domProps:{value:t.sendData.bankAccount},on:{change:function(e){t.$set(t.sendData,"bankAccount",e.target.value)}}})])]),t._v(" "),a("div",{staticClass:"item item_input",attrs:{flex:"box:first cross:center"}},[a("div",{staticClass:"name"},[t._v("开户支行")]),t._v(" "),a("div",{staticClass:"text_box",attrs:{flex:"cross:center"}},[a("input",{directives:[{name:"model",rawName:"v-model.lazy",value:t.sendData.bankAddress,expression:"sendData.bankAddress",modifiers:{lazy:!0}}],attrs:{type:"text",placeholder:"请输入开户支行"},domProps:{value:t.sendData.bankAddress},on:{change:function(e){t.$set(t.sendData,"bankAddress",e.target.value)}}})])]),t._v(" "),t.platform.needSMSForModifyBankInfo?a("div",{staticClass:"item item_input",attrs:{flex:"box:first cross:center"}},[a("div",{staticClass:"name"},[t._v("验证码")]),t._v(" "),a("div",{staticClass:"text_box",attrs:{flex:"cross:center box:last"}},[a("input",{directives:[{name:"model",rawName:"v-model.lazy",value:t.sendData.smsCode,expression:"sendData.smsCode",modifiers:{lazy:!0}}],attrs:{type:"tel",maxlength:"4",placeholder:"请输入短信验证码"},domProps:{value:t.sendData.smsCode},on:{change:function(e){t.$set(t.sendData,"smsCode",e.target.value)}}}),t._v(" "),t.reciprocal?a("span",{staticClass:"get_code red"},[t._v(t._s(t.reciprocal)+"s")]):a("div",{staticClass:"get_code",on:{click:t.getCode}},[t._v("获取验证码")])])]):t._e(),t._v(" "),a("div",{staticClass:"item item_btn"},[a("div",{staticClass:"btn",on:{click:t.send}},[t._v("更新")])])],1)],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("thead",[e("tr",[e("th",[this._v("类别")]),this._v(" "),e("th",[this._v("详情")])])])}]},d=a("VU/8")(r,c,!1,null,null,null);e.default=d.exports},ctWk:function(t,e,a){"use strict";var n=a("Dd8w"),s=a.n(n),i=a("NYxO"),o={name:"get_address",data:function(){return{provinceList:[],valueKey:[],cityList:[],address:{provinceId:"",cityId:""}}},props:{value:Object},methods:{changeCity:function(){var t=this;this.cityList=[],this.$api.getCityList({provinceId:this.address.provinceId}).then(function(e){t.cityList=e.data,t.address.cityId?t.address.cityId=e.data[0].id:t.address.cityId=t.value.cityId||e.data[0].id})}},mounted:function(){var t=this;console.log(this.value),this.$api.getProvinceList().then(function(e){e.data.map(function(t,a){e.data[a].id=t.id.toString()}),t.provinceList=e.data,t.address.provinceId=t.value.provinceId||e.data[0].id})},computed:s()({},Object(i.d)(["platform"])),watch:{"address.provinceId":function(){this.changeCity()},"address.cityId":function(){this.$emit("input",this.address)}}},r={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"item item_input address",attrs:{flex:"box:first cross:center"}},[a("div",{staticClass:"name"},[t._v("存款地址")]),t._v(" "),a("div",{staticClass:"text_box",attrs:{flex:"cross:center box:mean"}},[a("div",{staticClass:"select_box"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.address.provinceId,expression:"address.provinceId"}],attrs:{name:"province"},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.$set(t.address,"provinceId",e.target.multiple?a:a[0])}}},t._l(t.provinceList,function(e,n){return a("option",{key:n,domProps:{value:e.id}},[t._v(t._s(e.name))])})),t._v(" "),a("i")]),t._v(" "),a("div",{staticClass:"select_box"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.address.cityId,expression:"address.cityId"}],attrs:{name:"city"},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.$set(t.address,"cityId",e.target.multiple?a:a[0])}}},t._l(t.cityList,function(e,n){return a("option",{key:n,domProps:{value:e.id}},[t._v(t._s(e.name))])})),t._v(" "),a("i")])])])},staticRenderFns:[]},c=a("VU/8")(o,r,!1,null,null,null);e.a=c.exports}});